{
  "hash": "f78e856f6b2ba1a0c3e82dae786598c1",
  "result": {
    "markdown": "---\ntitle: \"Blog Post 3\"\nauthor: \"Denali Stevens\"\ndate: \"2024-03-08\"\nimage: \"Collegiate.jpeg\"\n---\n\n\n\n# Introduction\n\nIn this blog post I will be exploring the data set `Collegiate sports` from the github page [tidytuesday](https://github.com/rfordatascience/tidytuesday/blob/master/data/2022/2022-03-29/readme.md){target=\"_blank\"}, For this post I am interested in exploring the total revenue and expenditure for collegiate sports at a variety of schools. To do this I will use the variables \n\n**year**, the year the data represents\n\n**institution_name**, the school\n\n**classification_name**, the division\n\n**classification_code**, more information about the division\n\n**total_rev_menwomen**, total revenue generated by mens and womens sports\n\n**total_exp_menwomen**, total expenditures for mens and womens sports \n\n\n\n::: {.cell}\n\n:::\n\n# Primary Visualizations\n\nLet's start by looking at St. Lawrence and their revenue vs expenditure in all the years available in this dataset. \n\n::: {.cell}\n\n```{.r .cell-code}\nst_law <- CollegiateSports|> filter(institution_name == \"St Lawrence University\") |>\n  filter(!is.na(total_rev_menwomen), !is.na(total_exp_menwomen)) |>\n  group_by(year) |>\n  summarise(total_rev = sum(total_rev_menwomen), total_exp = sum(total_exp_menwomen)) |> \n  pivot_longer(cols = c(total_rev, total_exp),\n               names_to = \"Type\", values_to = \"Dollars\")\n\nggplot(data = st_law, aes(x = year, y = Dollars, fill = Type)) +\n  geom_col(position = \"dodge\") +\n  scale_fill_manual(values = c(\"#BD0000\", \"#964B00\")) +\n  scale_y_continuous(\"Dollars\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar()) +\n  labs(title = \"Total Revenue and Expenditure for Sports\\nat St. Lawrence University 2015-2019\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nSo this tells us that SLU doesn't properly report their data because it is highly unlikely that the revenue generated and the expenditures perfectly match up every year. \n\nLet's see if it will be more accurate with a school like University of Oregon, given its prominent sports programs \n\n::: {.cell}\n\n```{.r .cell-code}\nOregon <- CollegiateSports|> filter(institution_name == \"University of Oregon\") |>\n  filter(!is.na(total_rev_menwomen), !is.na(total_exp_menwomen)) |>\n  group_by(year) |>\n  summarise(total_rev = sum(total_rev_menwomen), total_exp = sum(total_exp_menwomen)) |> \n  pivot_longer(cols = c(total_rev, total_exp),\n               names_to = \"Type\", values_to = \"Dollars\")\n\nggplot(data = Oregon, aes(x = year, y = Dollars, fill = Type)) +\n  geom_col(position = \"dodge\") +\n  scale_fill_manual(values = c(\"#007030\", \"#FEE11A\")) +\n  scale_y_continuous(\"Dollars\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar()) +\n  labs(title = \"Total Revenue and Expenditure for Sports\\nat University of Oregon 2015-2019\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThis is much more interesting and gives good information. Lets look further into University of Oregon and see what else we can explore. Maybe the revenue of each sport\n\n::: {.cell}\n\n```{.r .cell-code}\nOregon_sports <- CollegiateSports |> filter(institution_name == \"University of Oregon\") |> \n  filter(!(is.na(total_rev_menwomen))) |>\n  group_by(year, sports) |> \n  summarise(total_rev = sum(total_rev_menwomen)) |>\n  arrange(total_rev)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nggplot(data = Oregon_sports, aes(x = factor(year), y = total_rev)) +\n  geom_boxplot() +\n  facet_wrap(~ sports) +\n  scale_y_continuous(\"total_rev\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## this is not very helpful and it looks like football and basketball are the only sports making a profit so lets just look closer at them \n\nOregon_FB <- Oregon_sports |>\n  filter(sports == \"Football\" | sports == \"Basketball\")\n\nggplot(data = Oregon_FB, aes(x = factor(year), y = total_rev, fill = sports)) +\n  geom_boxplot() +\n  scale_y_continuous(\"total_rev\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Boxplots still aren't great \n\nggplot(data = Oregon_FB, aes(x = factor(year), y = total_rev, group = sports)) +\n  geom_line(aes(colour = sports)) +\n  scale_y_continuous(\"total_rev\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Thats more helpful, try will all sports again \n\nggplot(data = Oregon_sports, aes(x = factor(year), y = total_rev, group = sports)) +\n  geom_line(aes(colour = sports)) +\n  scale_y_continuous(\"total_rev\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# The major difference between basketball, football, and everything else just makes\n# it very difficult to visualize all the sports at once. \n```\n:::\n\n\nMake one more plot of total revenue for all division 1 schools in the data set.\n\n::: {.cell}\n\n```{.r .cell-code}\n# filter so its only Division 1 sports \ndiv1 <- CollegiateSports |> filter(grepl('NCAA Division I', classification_name)) |> filter(classification_code <= 3)\n\nD1_totals <- div1|> \n  filter(!is.na(total_rev_menwomen)) |>\n  group_by(year, institution_name) |>\n  summarise(total_rev = sum(total_rev_menwomen))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n#overll top 5 \nd1_top5 <- D1_totals |> \n  group_by(institution_name) |>\n  summarise(total = sum(total_rev)) |>\n  arrange(desc(total)) |>\n  slice(1:5)\n\nggplot(data = D1_totals, aes(x = factor(year), y = total_rev, group = institution_name)) +\n  geom_line() +\n  scale_y_continuous(\"total_rev\",\n    breaks = scales::breaks_extended(8),\n    labels = scales::label_dollar())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# I wanted to color and label the top 5 for total revenue, but ran out of time\n```\n:::\n\n# Conclusion and Wrap-Up\nThere is definitely a lot more I could do with this data if I had put more time into it, but I just didn't have the time this week. The visualizations themselves could also be much better and need better labeling/details. But it is very interesting information and I would love to break it down by gender and sport in the future. \n\n## Connection to Class\nThe fine tuning of these graphs is what I think the class helps with the most, and given these graphs are still very messy the connection to class is not displayed very well. But they are more advanced graphs than I would have been able to do before this class. \n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}