---
title: "Blog Post 3"
author: "Denali Stevens"
date: "2024-03-08"
image: "Collegiate.jpeg"
---


# Introduction

In this blog post I will be exploring the data set `Collegiate sports` from the github page [tidytuesday](https://github.com/rfordatascience/tidytuesday/blob/master/data/2022/2022-03-29/readme.md){target="_blank"}, For this post I am interested in exploring the total revenue and expenditure for collegiate sports at a variety of schools. To do this I will use the variables 

**year**, the year the data represents

**institution_name**, the school

**classification_name**, the division

**classification_code**, more information about the division

**total_rev_menwomen**, total revenue generated by mens and womens sports

**total_exp_menwomen**, total expenditures for mens and womens sports 


```{r}
#| echo: false
#| warning: false
#| output: false 


library(tidyverse)
library(dplyr)
library(scales)
tuesdata <- tidytuesdayR::tt_load('2022-03-29')
tuesdata <- tidytuesdayR::tt_load(2022, week = 13)
CollegiateSports <- tuesdata$sports
```
# Primary Visualizations

Let's start by looking at St. Lawrence and their revenue vs expenditure in all the years available in this dataset. 
```{r}
st_law <- CollegiateSports|> filter(institution_name == "St Lawrence University") |>
  filter(!is.na(total_rev_menwomen), !is.na(total_exp_menwomen)) |>
  group_by(year) |>
  summarise(total_rev = sum(total_rev_menwomen), total_exp = sum(total_exp_menwomen)) |> 
  pivot_longer(cols = c(total_rev, total_exp),
               names_to = "Type", values_to = "Dollars")

ggplot(data = st_law, aes(x = year, y = Dollars, fill = Type)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values = c("#BD0000", "#964B00")) +
  scale_y_continuous("Dollars",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar()) +
  labs(title = "Total Revenue and Expenditure for Sports\nat St. Lawrence University 2015-2019")
```

So this tells us that SLU doesn't properly report their data because it is highly unlikely that the revenue generated and the expenditures perfectly match up every year. 

Let's see if it will be more accurate with a school like University of Oregon, given its prominent sports programs 
```{r}
Oregon <- CollegiateSports|> filter(institution_name == "University of Oregon") |>
  filter(!is.na(total_rev_menwomen), !is.na(total_exp_menwomen)) |>
  group_by(year) |>
  summarise(total_rev = sum(total_rev_menwomen), total_exp = sum(total_exp_menwomen)) |> 
  pivot_longer(cols = c(total_rev, total_exp),
               names_to = "Type", values_to = "Dollars")

ggplot(data = Oregon, aes(x = year, y = Dollars, fill = Type)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values = c("#007030", "#FEE11A")) +
  scale_y_continuous("Dollars",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar()) +
  labs(title = "Total Revenue and Expenditure for Sports\nat University of Oregon 2015-2019")
```

This is much more interesting and gives good information. Lets look further into University of Oregon and see what else we can explore. Maybe the revenue of each sport
```{r}
Oregon_sports <- CollegiateSports |> filter(institution_name == "University of Oregon") |> 
  filter(!(is.na(total_rev_menwomen))) |>
  group_by(year, sports) |> 
  summarise(total_rev = sum(total_rev_menwomen)) |>
  arrange(total_rev)

ggplot(data = Oregon_sports, aes(x = factor(year), y = total_rev)) +
  geom_boxplot() +
  facet_wrap(~ sports) +
  scale_y_continuous("total_rev",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar())
## this is not very helpful and it looks like football and basketball are the only sports making a profit so lets just look closer at them 

Oregon_FB <- Oregon_sports |>
  filter(sports == "Football" | sports == "Basketball")

ggplot(data = Oregon_FB, aes(x = factor(year), y = total_rev, fill = sports)) +
  geom_boxplot() +
  scale_y_continuous("total_rev",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar())
# Boxplots still aren't great 

ggplot(data = Oregon_FB, aes(x = factor(year), y = total_rev, group = sports)) +
  geom_line(aes(colour = sports)) +
  scale_y_continuous("total_rev",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar())

# Thats more helpful, try will all sports again 

ggplot(data = Oregon_sports, aes(x = factor(year), y = total_rev, group = sports)) +
  geom_line(aes(colour = sports)) +
  scale_y_continuous("total_rev",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar())

# The major difference between basketball, football, and everything else just makes
# it very difficult to visualize all the sports at once. 
```

Make one more plot of total revenue for all division 1 schools in the data set.
```{r}
# filter so its only Division 1 sports 
div1 <- CollegiateSports |> filter(grepl('NCAA Division I', classification_name)) |> filter(classification_code <= 3)

D1_totals <- div1|> 
  filter(!is.na(total_rev_menwomen)) |>
  group_by(year, institution_name) |>
  summarise(total_rev = sum(total_rev_menwomen))

#overll top 5 
d1_top5 <- D1_totals |> 
  group_by(institution_name) |>
  summarise(total = sum(total_rev)) |>
  arrange(desc(total)) |>
  slice(1:5)

ggplot(data = D1_totals, aes(x = factor(year), y = total_rev, group = institution_name)) +
  geom_line() +
  scale_y_continuous("total_rev",
    breaks = scales::breaks_extended(8),
    labels = scales::label_dollar())

# I wanted to color and label the top 5 for total revenue, but ran out of time

```
# Conclusion and Wrap-Up
There is definitely a lot more I could do with this data if I had put more time into it, but I just didn't have the time this week. The visualizations themselves could also be much better and need better labeling/details. But it is very interesting information and I would love to break it down by gender and sport in the future. 

## Connection to Class
The fine tuning of these graphs is what I think the class helps with the most, and given these graphs are still very messy the connection to class is not displayed very well. But they are more advanced graphs than I would have been able to do before this class. 

